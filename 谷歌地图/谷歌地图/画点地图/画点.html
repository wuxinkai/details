<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="//cdn.bootcss.com/leaflet/0.7.7/leaflet.css" rel="stylesheet">
    <script src="//cdn.bootcss.com/leaflet/0.7.7/leaflet.js"></script>
    <script src="js/leaflet-pip.min.js"></script>
    <title>example for pointInLayer</title>
</head>
<body>
<div id="map" style="height: 850px;"></div>
</body>
</html>
<script>


    var map = L.map('map').setView([22.5365321328,113.9173539538], 13);
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var polygons = L.geoJson(states).addTo(map);
    var points = L.geoJson(geojson).addTo(map);

    points.eachLayer(function(l){
        var results = leafletPip.pointInLayer(l.getLatLng(),polygons,true);
        if(results.length>0){

            results.forEach(function(r){
                console.log(r);
                r.setStyle({color: 'red'});
            });
        }
    });
    var poly_points = [];//区域
    var poly_line=new L.Polyline([]);//折线
    var map = new L.Map('map', {
        layers: [cloudmade],
        center: new L.LatLng(39.69596043694606, -104.95084762573242),
        zoom: 12,
        doubleClickZoom :false//不可以通过双击放大，因为双击的作用是添加矩形
    });
    map.on('click', addClickLatlng);//单击，添加点
    map.on('dblclick', showPoly);//双击，显示面
    //画矩形
    function addClickLatlng(e){
        //当前点
        var clickLocation=[e.latlng.lat,e.latlng.lng];
        poly_points.push(clickLocation);
        //显示折线
        poly_line.addLatLng(e.latlng);
        map.addLayer(poly_line);
        //var point=new L.Point(e.layerPoint.x,e.layerPoint.y);
    }
    //显示矩形
    function showPoly(){
        for (var i = 0, latlngs = [], len = poly_points.length; i < len; i++) {
            latlngs.push(new L.LatLng(poly_points[i][0], poly_points[i][1]));
        }
        var poly = new L.Polygon(latlngs);
        map.addLayer(poly);
        //清空
        poly_points=[];
        poly_line=new L.Polyline([]);
    }


</script>